!function(_){"use strict";var n=_("body");function r(a,t){t.removeClass("loading"),_.magnificPopup.open({mainClass:"mfp-fade popup-product-quick-view",items:{src:a.html(),type:"inline"},callbacks:{open:function(){var a=this.content.find(".product-container"),t=window.innerHeight,t=parseInt(t-60),t=Math.min(t,760);a.outerHeight(t),a.perfectScrollbar({suppressScrollX:!0});var t=this.content.find(".woo-single-gallery"),a=t.children(".edumall-thumbs-swiper").EdumallSwiper(),p=t.children(".edumall-main-swiper").EdumallSwiper({thumbs:{swiper:a}});"undefined"!=typeof isw&&void 0!==isw.Swatches&&isw.Swatches.init(),"undefined"!=typeof wc_add_to_cart_variation_params&&this.content.find(".variations_form").each(function(){_(this).wc_variation_form()});var f=this.content.find(".variations_form"),m=f.data("product_variations");f.find("select").on("change",function(){for(var a=!0,t=!1,i={},e=f.serializeArray(),n=0;n<e.length;n++){var r=e[n].name;if("attribute_"===r.substring(0,10)&&(i[r]=e[n].value,""===e[n].value)){a=!1;break}}if(!0===a){for(var d=Object.entries(i),o=0,c=0,n=m.length-1;0<=n;n--){var s=m[n],l=Object.entries(s.attributes),u=0;l.forEach(([i,e])=>{d.forEach(([a,t])=>{a===i&&(t!==e&&""!==e||u++)})}),c<u&&(c=u,o=s.image_id)}o?p.$wrapperEl.find(".swiper-slide").each(function(a){var t=_(this).attr("data-image-id");if((t=parseInt(t))===o)return p.slideTo(a),!1}):t=!0}else t=!0;t&&(t=p.$wrapperEl.find(".product-main-image").index(),p.slideTo(t))})}}})}_(document).ready(function(){var e;_(".edumall-product").on("click",".quick-view-btn",function(a){a.preventDefault(),a.stopPropagation();var t=_(this);t.parents(".product-actions").first().addClass("refresh"),t.addClass("loading");var a=t.data("pid"),i=n.children("#popup-product-quick-view-content-"+a);0<i.length?r(i,t):_.ajax({url:$edumall.ajaxurl,type:"POST",data:_.param({action:"product_quick_view",pid:a}),dataType:"json",success:function(a){i=_(a.template),n.append(i),r(i,t)}})}),e=[],n.on("click",".ajax_add_to_cart:not(.disabled)",function(){var a=_(this).parents(".cart-notification").first().data("notification"),t='<span class="added-text">'+$edumall.noticeAddedCartText+"</span>",i=t;void 0!==a&&(i='<div class="product-added-cart">',""!==a.image&&(i+='<div class="product-thumbnail"><img src="'+a.image+'" alt="'+a.title+'"/></div>'),i+='<div class="product-caption"><h3 class="product-title">'+a.title+" </h3>"+t+"</div>",i+="</div>"),i+='<div class="tm-button-wrapper btn-view-cart"><a href="'+$edumall.noticeCartUrl+'" class="tm-button button-grey style-flat tm-button-xs tm-button-full-wide">'+$edumall.noticeCartText+"</a></div>",e.push(i)}),n.on("added_to_cart",function(){for(var a=0;a<e.length;a++){var t=e[a];_.growl({location:"br",duration:5e3,title:"",message:t}),e.splice(a,1)}}),function(){if("undefined"==typeof wc_add_to_cart_params)return;_(document).on("click",".single_add_to_cart_button",function(a){var t=_(this);if(!t.hasClass("external-add-to-cart-button")){if(a.preventDefault(),t.hasClass("disabled"))return!1;if(t.hasClass("woosb-disabled"))return!1;var i=_(this).closest("form.cart"),a=(i.find("input[name=variation_id]").val(),i.find("input[name=product_id]").val());i.find("input[name=quantity]").val();"add-to-cart"===t.attr("name")&&(a=t.val()),t.removeClass("added").addClass("loading updating-icon");var e={action:"edumall_woocommerce_add_to_cart",product_id:a};return i.serializeArray().map(function(a){var t;"add-to-cart"!==a.name&&(a.name.endsWith("[]")?((t=a.name.substring(0,a.name.length-2))in e||(e[t]=[]),e[t].push(a.value)):e[a.name]=a.value)}),_("body").trigger("adding_to_cart",[t,e]),_.post(wc_add_to_cart_params.ajax_url,e,function(a){a&&(a.error&&a.product_url?window.location=a.product_url:"yes"!==wc_add_to_cart_params.cart_redirect_after_add?_(document.body).trigger("added_to_cart",[a.fragments,a.cart_hash,t]):window.location=wc_add_to_cart_params.cart_url)}).always(function(){t.addClass("added").removeClass("loading updating-icon")}),!1}})}()})}(jQuery);